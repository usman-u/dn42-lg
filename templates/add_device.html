{% extends "base.html" %}

{% block title %} Add Device {%endblock%}

{% block content %}


{% for message in get_flashed_messages() %}
<div class="alert alert-warning alert-dismissible fade show" role="alert">
  <strong> {{ hostname }} | {{ device_type}}</strong> just added.
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
{% endfor %}

{% if hostname %} 
    <div class="shadow-lg p-3 mb-5 bg-body rounded">

      <table class="table table-striped table-hover table-bordered">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Hostname</th>
            <th scope="col">Device Type</th>
            <th scope="col">Username</th>
            <th scope="col">Password</th>
            <th scope="col">Use Keys</th>
            <th scope="col">Key File Location</th>
            <th scope="col">Secret</th>
          </tr>
        </thead>
        <tbody>

      {% for device in all_devices %}
            <th scope="row">{{ device.id }}</th>
            <td> {{device.hostname }}</td>
            <td> {{device.device_type}}</td>
            <td> {{device.username}}</td>
            <td> {{device.password }}</td>
            <td> {{device.usekeys }}</td>
            <td> {{device.keyfile }}</td>
            <td> {{device.secret }}</td>
          </tr>
      {% endfor %}
        </tbody>
      </table>
      <br/>
    </div>
{% else %}

    <br>

    <form method =  "POST">
        <!-- form.x = parsed data from form logic -->
        {{ form.hidden_tag() }}   

      <div class="shadow-lg p-3 mb-5 bg-body rounded">

        <h1>Add Device</h1>

        <div class="row g-3">
          <div class="col-md-4">
            {{ form.hostname.label (class="form-label") }}
            {{ form.hostname (class="form-control" )}}
          </div>
          <div class="col-md-4">
            {{ form.nickname.label (class="form-label") }}
            {{ form.nickname (class="form-control" )}}
          </div>
          <div class="col-md-4">
          {{ form.device_type.label (class="form-label") }}
          {{ form.device_type (class="form-control") }}
          </div>
        </div>
        <br>
        <div class="row g-3">
          <div class="col-md-6">
          {{ form.username.label (class="form-label") }}
          {{ form.username (class="form-control") }}
          </div>
          <div class="col-md-6">
          {{ form.password.label (class="form-label") }}
          {{ form.password (class="form-control") }}
          </div>
        </div>

        <div class="row g-3">
          <div class="col-md-6">
          {{ form.use_keys (class="form-check-input") }}
          {{ form.use_keys.label (class="form-check-label") }}
          </div>
          <div class="col-md-6">
          {{ form.key_file.label (class="form-label") }}
          {{ form.key_file (class="form-control") }}
          </div>
        </div>
          {{ form.secret.label (class="form-label") }}
          {{ form.secret (class="form-control") }}
          <br>
          {{ form.submit(class="btn btn-secondary") }}
      </div>
    </form>

    <br/>
    <br/>
    <div class="shadow-lg p-3 mb-5 bg-body rounded">

      <table class="table table-striped table-hover table-bordered">
        <h1>Inventory</h1>
        <br>
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Nickname</th>
            <th scope="col">Hostname</th>
            <th scope="col">Device Type</th>
            <th scope="col">Username</th>
            <th scope="col">Password</th>
            <th scope="col">Use Keys</th>
            <th scope="col">Key File Location</th>
            <th scope="col">Secret</th>
            <th scope="col">Other</th>
          </tr>
        </thead>
        <tbody>

      {% for device in all_devices %}
            <th scope="row">{{ device.id }}</th>
            <td> {{ device.hostname }} </td>
            <td> {{ device.nickname }} </td>
            <td> {{device.device_type}}</td>
            <td> {{device.username}}</td>
            <td> {{device.password }}</td>
            <td> {{device.usekeys }}</td>
            <td> {{device.keyfile }}</td>
            <td> {{device.secret }}</td>
            <td> <a href="{{ url_for('update', id=device.id) }}"> EDIT</td>
          </tr>
      {% endfor %}
        </tbody>
      </table>
      <br/>
    </div>

{% endif %}

{% endblock %}